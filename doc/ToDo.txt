/*
 * ToDo.h
 *
 * Created: 30-6-2019 00:42:46
 *  Author: huub Buis
 */ 



Done 2019-06-30 Disable limit switch alarm on Y-axis limit
*- add sync pulse report
*- add counter for sync pulses
*- add Generate report at every sync pulse
*- make sync pulse report depending on report configuration setting (bit 7)
- add G33 command for waiting for spindle pulse or modify the G04 when G95 is active
- add configuration setting for enabling reporting threading accuray at each index pulse
- add configuration setting for synchronisation pulses per revolution
- add probe pulse counter counting at every probe input high/low transition debounced

    ////// Upon limit pin change, enable watchdog timer to create a short delay. 
    ISR(LIMIT_INT_vect)
	{ 
		if (limits_get_state(LIMIT_PIN_MASK_Y_AXIS)) { //process Y-axis without debouncing
			//process_limit_pin_change_event(); //process after debouncing
		//}
		//else {
    	  if (!(WDTCSR & (1<<WDIE))) {	// if the watch dog interrupt is not enabled
	        WDTCSR |= (1<<WDIE);		//enable the watch dog interrupt
	      } 
		//}
	}
   
	//After the Watch dog timeout (33 ms) the limit change is handled
	ISR(WDT_vect) // Watchdog timer ISR
    {
      WDTCSR &= ~(1<<WDIE); // Disable watchdog timer. 
	  process_limit_pin_change_event(); //process after debouncing
    }
  //#endif